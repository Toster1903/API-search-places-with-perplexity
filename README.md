
## Описание

Smart Place Search API — это сервис на FastAPI для поиска интересных мест Ростова-на-Дону и области командно, с использованием:
- локальной семантической базы на ruBERT-эмбеддингах,
- генеративного до-поиска через Perplexity API (если не найдено релевантных результатов).

Система фильтрует нерелевантные и технические запросы по смыслу.

***

## Как запустить

### 1. Клонируй репозиторий и установи зависимости

```bash
git clone https://github.com/Toster1903/hahaton.git
cd hahaton
python -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
```

### 2. Создай `.env`

Добавь файл `.env` с переменной:

```
PPLX_API_KEY=ваш_ключ_от_perplexity
```

### 3. Запусти FastAPI сервер

```bash
uvicorn get_response_user:app --host 0.0.0.0 --port 5000 --reload
```

### 4. Про примеры запросов

POST `/search`
```json
{
  "query": "кафе с грузинской кухней на набережной",
  "max_results": 5
}
```
◄ 0s ◎ curl -X POST "http://127.0.0.1:5000/search" \                                                                                                                    ⌂ 10:53
             -H "Content-Type: application/json" \
             -d '{"query": "хинкали", "max_results": 5}'

Ответ — структура:

- Если есть релевантные места:  
  ```json
  {
    "source": "database" | "mixed" | "perplexity",
    "results": [ { "title": "...", ... } ],
    "best_similarity": 0.78
  }
  ```
  {"source":"perplexity","results":[{"title":"Старик Хинкалыч","description":"Популярная сеть хинкальных с уютной атмосферой, живой музыкой и разнообразным меню грузинской кухни, в том числе хинкали и хачапури. Один из лучших ресторанов по отзывам в Ростове.","tags":["грузинская кухня","хинкали","хачапури","кавказская кухня"],"transport":"На автомобиле или общественным транспортом до ул. Пушкинская, 116","address":"Ростов-на-Дону, ул. Пушкинская, 116","price":1056,"time":60,"similarity_score":1.0},{"title":"Хинкали и Эклеры","description":"Грузинское бистро с авторскими блюдами, включая хинкали и разнообразные десерты. Идеально для тех, кто хочет попробовать традиционные и необычные варианты хинкали.","tags":["грузинская кухня","хинкали","десерты","кавказская кухня"],"transport":"На автомобиле или пешком до ул. Большая Садовая, 160","address":"Ростов-на-Дону, ул. Большая Садовая, 160","price":1500,"time":45,"similarity_score":1.0},{"title":"Лали Хинкали","description":"Ресторан грузинской кухни с акцентом на традиционные рецепты хинкали, доставкой еды и комфортной атмосферой в центре города.","tags":["грузинская кухня","хинкали","доставка","шашлык"],"transport":"Прямой доступ от Будённовского проспекта","address":"Ростов-на-Дону, пр-т Будённовский, 33","price":1000,"time":50,"similarity_score":1.0},{"title":"Хинкали Djan","description":"Современный грузинский ресторан с живой музыкой, обширным выбором хинкали и других традиционных блюд, расположенный в районе Нахичевань.","tags":["грузинская кухня","хинкали","живая музыка"],"transport":"На автомобиле или общественным транспортом до района Нахичевань","address":"Ростов-на-Дону, ул. Нахичевань","price":1400,"time":60,"similarity_score":1.0},{"title":"Ваха Лавка","description":"Колоритное грузинское бистро с домашней кухней, в том числе хинкали, хачапури и блюда на вынос с доставкой.","tags":["грузинская кухня","хинкали","хачапури","доставка"],"transport":"На общественном транспорте до Ворошиловского проспекта","address":"Ростов-на-Дону, Ворошиловский проспект","price":1300,"time":40,"similarity_score":1.0}],"best_similarity":0.46400171518325806}⏎


- Если нерелевантный запрос ("как починить лампочку"):  
  title = "Ошибка", description = "Извините, мы не можем обработать такой запрос. Пожалуйста, обратитесь в поддержку."

***

## Структура проекта


- `get_response_user.py` — FastAPI сервер и логика поиска
- `places_meta.json`, `embeddings.npy` — база мест и эмбеддинги
- `test_RUBERT.py`, `ruBERT_recognize.py` — скрипты генерации/теста эмбеддингов
- `rostov_all_places_full.json` — полный JSON со всеми местами
- `requirements.txt` — зависимости для повторного запуска

***

## Что внутри

- **Semantic Search:** ruBERT находит наиболее похожие записи по смыслу среди всех мест Ростова.
- **Perplexity Fallback:** если совпадения в базе "слабые", системой будет дополнен ответ через Perplexity API с инструкцией вернуть только релевантные места/пустой массив при off-topic.
- **Фильтр темы:** если ваш запрос не по теме туризма или города — сервис корректно сообщит об этом.

***


## Лицензия

MIT License


